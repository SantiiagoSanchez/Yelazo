@page "/tienda"
@layout EmptyLayout

@inject IHttpServicio http

@Mensaje

<link href="/css/tienda.css" rel="stylesheet" />

<div class="d-flex flex-column min-vh-100">

    <!-- Barra superior -->
    <header class="topbar">
        <div class="brand">YELAZO!</div>
        <a href="#" class="cart">
            <i class="bi bi-cart3"></i>
            Carrito (0)
        </a>
    </header>

    <!-- Encabezado -->
    <section class="hero-section text-white text-center py-5 mb-0">
        <div class="container">
            <h1 class="fw-bold display-5 mb-3">SOBRE NOSOTROS</h1>
            <p class="lead mb-0">
                Desde 1987 cumpliendo los estándares más altos en servicio y atención.<br />
                Nos dedicamos a producir, envasar, almacenar y distribuir hielo.
            </p>
        </div>
    </section>

    <!-- Productos -->
    <section class="flex-grow-1 py-5" style="background-color:#F0F8FF;">
        <div class="container">
            <h2 class="text-center fw-bold mb-5 text-dark">Nuestros Productos</h2>

            @if (productos is null)
            {
                <div class="text-center text-secondary py-5">Cargando productos...</div>
            }
            else if (!productos.Any(p => p.Estado))
            {
                <div class="text-center text-muted py-5">No hay productos activos disponibles.</div>
            }
            else
            {
                <div class="row g-4 justify-content-center">
                    @foreach (var producto in productos.Where(p => p.Estado))
                    {
                        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                            <div class="card product-card border-0 shadow-sm h-100">
                                <div class="position-relative overflow-hidden">
                                    <img src="@imagenPorDefecto"
                                         class="card-img-top product-img"
                                         alt="Imagen de @producto.Nombre" />
                                </div>
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title fw-semibold text-dark mb-2">
                                        @($"{producto.Nombre} {producto.Presentacion}")
                                    </h5>
                                    <p class="card-text text-secondary small flex-grow-1">@producto.Descripcion</p>
                                    <p class="fw-bold text-primary fs-5 mb-3">
                                        @producto.Precio $
                                    </p>
                                    <button class="btn btn-gradient w-100 rounded-pill py-2 mt-auto">
                                        <i class="bi bi-cart-plus me-2"></i> Añadir al Carrito
                                    </button>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-modern text-white text-center py-4 mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-md-6 mb-3 mb-md-0">
                    <h5 class="fw-bold">HIELO PURO</h5>
                    <p class="small mb-0">
                        Ofrecemos el mejor hielo para todas tus necesidades desde 1985.<br />
                        Calidad garantizada en cada bolsa.
                    </p>
                </div>
                <div class="col-md-6">
                    <h5 class="fw-bold">Contacto</h5>
                    <p class="small mb-0">
                        info@hielopuro.com<br />
                        +52 (555) 123-4567<br />
                        Avenida Amadeo Sabattini 5313
                    </p>
                </div>
            </div>
            <hr class="border-light opacity-25 my-3" />
            <p class="small mb-0 text-white-50">&copy; 2025 Yelazo. Todos los derechos reservados.</p>
        </div>
    </footer>
</div>
@code {
    private List<Producto>? productos;
    private string imagenPorDefecto = "https://th.bing.com/th/id/R.69e0e202dc64320acf1b83f533690dc8?rik=sChSobWDBKU%2faA&pid=ImgRaw&r=0";
    public string Mensaje { get; set; } = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await Leer();
    }

    private async Task Leer()
    {
        var resp = await http.Get<List<Producto>>("api/Productos");

        if (!resp.Error)
        {
            productos = resp.Respuesta;
        }
        else
        {
            Mensaje = "Error";
        }

    }
}
